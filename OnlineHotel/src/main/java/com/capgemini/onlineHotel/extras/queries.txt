CREATE DATABASE HotelReservationDB;

USE HotelReservationDB;

CREATE TABLE HOTELS (
	HOTEL_ID int NOT NULL,
    HOTEL_NAME VARCHAR(30) NOT NULL,
    ADDRESS VARCHAR(100) NOT NULL,
    PRIMARY KEY (HOTEL_ID)
);

CREATE TABLE ROOMS (
	HOTEL_ID int NOT NULL, 
    ROOM_TYPE VARCHAR(15) NOT NULL, 
    NO_OF_ROOMS int NOT NULL, 
    AMENITIES VARCHAR(100) NOT NULL, 
    NO_OF_GUESTS int NOT NULL, 
    PRICE_PER_ROOM int NOT NULL,
    CONSTRAINT PK_ROOM PRIMARY KEY (HOTEL_ID, ROOM_TYPE),
    CONSTRAINT FK_HOTEL FOREIGN KEY (HOTEL_ID) REFERENCES HOTELS(HOTEL_ID)
);

CREATE TABLE SCHEDULED_STAYS (
	STAY_ID int NOT NULL,
    BOOKING_ID int NOT NULL, 
    HOTEL_ID int NOT NULL, 
    ROOM_TYPE VARCHAR(15) NOT NULL,
    GUEST_NAME VARCHAR(20) NOT NULL, 
    PHONE_NO VARCHAR(10) NOT NULL, 
    CHECK_IN_DATE date NOT NULL, 
    CHECK_OUT_DATE date NOT NULL,
    PRIMARY KEY (STAY_ID),
    CONSTRAINT FK_SS1 FOREIGN KEY (BOOKING_ID) REFERENCES BOOKINGS(BOOKING_ID),
    CONSTRAINT FK_SS2 FOREIGN KEY (HOTEL_ID, ROOM_TYPE) REFERENCES ROOMS(HOTEL_ID, ROOM_TYPE)
);

CREATE TABLE BOOKINGS (
    BOOKING_ID int NOT NULL,
    BOOKING_DATE date NOT NULL,
    USER_NAME VARCHAR(20) NOT NULL,
    BOOKING_STATUS VARCHAR(15) NOT NULL,
    PRIMARY KEY (BOOKING_ID)
);

INSERT INTO HOTELS VALUES (1, "Hotel Regency", "Sector - 2, Salt lake, Kolkata");

INSERT INTO ROOMS VALUES (1, "DELUXE", 5, "Wifi, AC, Double Beds, Sea View", 4, 10000);
INSERT INTO ROOMS VALUES (1, "SINGLE", 16, "Wifi, Single Bed, TV", 2, 2000);
INSERT INTO ROOMS VALUES (1, "DOUBLE", 20, "Wifi, AC, Twin Bed, TV", 3, 4000);

INSERT INTO BOOKINGS VALUES (1, "2020-05-07", "anish", "UPCOMING");

INSERT INTO SCHEDULED_STAYS VALUES (1, 1, 1, "DELUXE", "Anish Basu", "7876543210", "2020-05-14", "2020-05-20");

